<script class="giscus-script" src="https://giscus-one.vercel.app/client.js"
    data-repo="tripos-education/maths-tripos-questions"
    data-repo-id="R_kgDOHNk5nA"
    data-category="Question comments"
    data-category-id="DIC_kwDOHNk5nM4CO-nf"
    data-mapping="pathname"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="bottom"
    data-theme="light"
    data-lang="en"
    data-discussions-summary={{ latestComments }}
    crossorigin="anonymous"
    async>
</script>

<script>
// additional script to align the giscus theme to the page theme
function sendMessage(message) {
  const iframe = document.querySelector('iframe.giscus-frame');
  if (!iframe) return;
  iframe.contentWindow.postMessage({ giscus: message }, iframe.src);
}

var darkModeQuery = window.matchMedia("(prefers-color-scheme: dark)");

if (darkModeQuery.matches) {
	const gscript= document.querySelector('script.giscus-script');
	gscript.setAttribute("data-theme","dark");
}

darkModeQuery.addListener(function (query) {
	if (query.matches) {
		sendMessage({
  			setConfig: {
    				theme: 'dark'
 			 }
		});
	} else {
		sendMessage({
  			setConfig: {
    				theme: 'light'
 			 }
		});
	}
});
</script>